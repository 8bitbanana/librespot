language: rust
rust:
  - stable
  - beta
  - nightly

addons:
  apt:
    packages:
      - libprotoc-dev
      - portaudio19-dev

script:
    - cargo build --no-default-features --features "with-syntex"
    - cargo build --no-default-features --features "with-syntex with-tremor"
    - cargo build --no-default-features --features "with-syntex facebook"
    - cargo build --no-default-features --features "with-syntex portaudio-backend"
    # Building without syntex only works on nightly
    - if [[ $(rustc --version) == *"nightly"* ]]; then
        cargo build --no-default-features;
      fi

matrix:
  allow_failures:
    - rust: nightly
